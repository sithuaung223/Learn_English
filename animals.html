<!DOCTYPE html>
<html>
<body>
<script type="text/javascript" src="temp.json"></script>
<script src="canvas.js"></script>

<script>
function createCanvas(c_word, c_meaning, i) {
	moveKeyDisplayHandler(i);	
  c= document.createElement("canvas");
	c.id = "mycanvas";
	c.name = i;
	c.width = 300;
	c.height = 500;
	c.style.border = '1px solid #d3d3d3';
	c.onclick = function(){clickCanvas(c,c_word, c_meaning, i)};

	addLabelToCanvas(c, c_word);
	var panel = document.getElementById("main_panel");
	panel.insertBefore(c, panel.childNodes[2]);
}

function deleteCanvas(e) {
	e.parentNode.removeChild(e);
}

function clickCanvas(e,e_word, e_meaning, i) {
	deleteCanvas(e); createCanvas(e_meaning, e_word, i);
}

function addLabelToCanvas(e, label) {
	var ctx = e.getContext("2d");
	ctx.textAlign = "center";
	ctx.fillText(label, e.width/2, e.height/2);
}

function clickMove(move) {
	if (move == "back") {
		window.location= './main.html';
	}

	var new_c;
	var c = document.getElementById("mycanvas");
	console.log(i);
	deleteCanvas(c);

	var i = c.name;
	var c_word = "N/A";
	var c_meaning = "Out of Index";
	if (move == "left") {
		i = i-1;
	}else if (move == "right") {
		i = i+1;
	}

	c_word = word_arr[i];
	c_meaning = meaning_arr[c_word];
	new_c = createCanvas(c_word, c_meaning, i);
}

function moveKeyDisplayHandler(i) {
	var left = document.getElementById("move_left");
	var right = document.getElementById("move_right");
	var back = document.getElementById("back");

	back.style.display = "none";
	if (i == 0) {
		left.style.display = "none";
	} 
	else if (i == word_arr.length-1) {
		right.style.display = "none";
		back.style.display = "";
	} 
	else {
		left.style.display = "";
		right.style.display = "";
	}
}

function getParamFromURL(param) {
	var url_string = window.location.href;
	var url = new URL(url_string);
	var value = url.searchParams.get(param);
	return value;
}



function main(){
	var selected_category = getParamFromURL("category");
	var vocabulary = JSON.parse(data);
	var meaning_dict = vocabulary[selected_category];

	var card = {
		id: 0,
		word: ['card', 'card_meaning'],
		flip: 0
	};
	var canvas = createCanvasWithCard(document, card);

	var prev_btn = createButton(document, 'prev');
	var next_btn = createButton(document, 'next');

	document.body.appendChild(prev_btn);
	document.body.appendChild(canvas);
	document.body.appendChild(next_btn);

	//writeTextToCanvas(canvas, Object.keys(meaning_dict)[0]);
	// createCanvas(word_arr[0], meaning_dict[word_arr[0]], 0);

	// var left = document.getElementById("move_left");
	// addLabelToCanvas(left, "<< Prev");
	// left.onclick = function() {clickMove("left")};

	// var right = document.getElementById("move_right");
	// addLabelToCanvas(right, "Next >>");
	// right.onclick = function() {clickMove("right")};

	// var back = document.getElementById("back");
	// addLabelToCanvas(back, "Back To Main Page");
	// back.onclick = function() {clickMove("back")};

	//-create dictionary for vocabulary
	//-create canvas for 1 word, canvas for next and previous
}

main();
</script> 

</body>
</html>

